#!/usr/bin/env bash
file=/etc/nixos/configuration.nix
vpnFile="/etc/nixos/wireguard.nix"

message="VPN is ON. Turning off..."
old=$vpnFile
new=\#$vpnFile
if [ $(cat $file | grep \#$vpnFile) ]; then
  message="VPN is OFF. Turning on..."
  old=\#$vpnFile
  new=$vpnFile
fi

echo $message
sudo sed -i "s|$old|$new|" $file
sudo nixos-rebuild switch
