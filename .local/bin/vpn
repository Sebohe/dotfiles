#!/usr/bin/env bash
file=/etc/nixos/configuration.nix
vpnFile="/etc/nixos/wireguard.nix"

if [ $(cat $file | grep \#$vpnFile) ]; then
  echo "VPN is OFF. Turning on..."
  old=\#$vpnFile
  new=$vpnFile
else
  echo "VPN is ON. Turning off..."
  old=$vpnFile
  new=\#$vpnFile
fi

sudo sed -i "s|$old|$new|" $file
sudo nixos-rebuild switch
